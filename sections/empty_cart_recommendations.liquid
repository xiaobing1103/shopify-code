{%- comment -%}
  Empty Cart Recommendations Section
  可在任何地方复用的空购物车推荐商品section
  用法: {% section 'empty_cart_recommendations' %}
{%- endcomment -%}

<style>
  /* ============================================
     Empty Cart Recommendations - Match Design Spec
     ============================================ */

  .t4s-empty-cart-recommendations {
    padding: 0 20px;
    margin-bottom: 20px;
    margin-top: 16px;
  }

  .t4s-empty-cart-recommendations__title {
    font-size: 18px;
    font-weight: 600;
    color: #1a1a1a;
    margin-bottom: 16px;
    text-align: left;
  }

  .t4s-empty-cart-recommendations__grid {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 12px;
  }

  .t4s-empty-cart-recommendations__item {
    background: #ffffff;
    border-radius: 16px;
    overflow: hidden;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.06);
    display: flex;
    flex-direction: column;
    text-decoration: none;
    transition: transform 0.2s ease;
    position: relative;
  }

  .t4s-empty-cart-recommendations__item:active {
    transform: scale(0.98);
  }

  .t4s-empty-cart-recommendations__image-wrapper {
    position: relative;
    width: 100%;
    padding-top: 100%;
    overflow: hidden;
  }

  .t4s-empty-cart-recommendations__image {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    object-fit: cover;
  }

  .t4s-empty-cart-recommendations__badge {
    position: absolute;
    top: 12px;
    left: 12px;
    background: rgba(255, 255, 255, 0.95);
    padding: 4px 10px;
    border-radius: 4px;
    font-size: 11px;
    font-weight: 500;
    color: #666;
    display: flex;
    align-items: center;
    gap: 4px;
    backdrop-filter: blur(8px);
    z-index: 1;
  }

  .t4s-empty-cart-recommendations__content {
    padding: 12px;
    display: flex;
    flex-direction: column;
    gap: 6px;
    flex: 1;
  }

  .t4s-empty-cart-recommendations__product-title {
    font-size: 15px;
    font-weight: 600;
    color: #1a1a1a;
    margin: 0;
    line-height: 1.3;
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
    display: none;
  }

  .t4s-empty-cart-recommendations__price-wrapper {
    display: flex;
    align-items: center;
    gap: 6px;
    display: none;
  }

  .t4s-empty-cart-recommendations__price {
    font-size: 18px;
    font-weight: 700;
    color: #1a1a1a;
    margin: 0;
  }

  .t4s-empty-cart-recommendations__compare-price {
    font-size: 14px;
    color: #999;
    text-decoration: line-through;
    margin: 0;
  }

  /* Responsive */
  @media (max-width: 767px) {
    .t4s-empty-cart-recommendations {
      padding: 0 16px;
      margin-top: 12px;
    }

    .t4s-empty-cart-recommendations__title {
      font-size: 16px;
      margin-bottom: 12px;
    }
  }
</style>

{%- liquid
  assign se_stts = section.settings
  assign title = se_stts.title | default: 'Guess you like it'
  assign heading = se_stts.heading
  assign product_limit = se_stts.product_limit | default: 4
  assign collection_handle = se_stts.collection | default: 'all'
  assign selected_collection = collections[collection_handle]
-%}

{%- if selected_collection.products.size > 0 -%}
  <div class="t4s-empty-cart-recommendations">
    {%- if title != blank -%}
      <h3 class="t4s-empty-cart-recommendations__title">
        {{ title }}
      </h3>
    {%- endif -%}

    <div class="t4s-empty-cart-recommendations__grid">
      {%- for product in selected_collection.products limit: product_limit -%}
        {%- liquid
          assign pr_url = product.url
          assign image = product.featured_media
          assign has_sale = false
          assign compare_price = product.compare_at_price
          assign price = product.price

          if compare_price > price
            assign has_sale = true
          endif
        -%}

        <a href="{{ pr_url }}" class="t4s-empty-cart-recommendations__item" data-loading-bar>
          <div class="t4s-empty-cart-recommendations__image-wrapper">
            {%- if image != blank -%}
              <img
                src="{{ image | image_url: width: 400 }}"
                alt="{{ image.alt | escape }}"
                class="t4s-empty-cart-recommendations__image"
                width="400"
                height="400"
                loading="lazy"
              >
            {%- else -%}
              {{ 'image' | placeholder_svg_tag: 't4s-empty-cart-recommendations__image' }}
            {%- endif -%}

            {%- comment -%} Badge - Same as ss-featured-collection-6 {%- endcomment -%}
            {%- if heading != blank -%}
              <div class="t4s-empty-cart-recommendations__badge">
                {{ heading }}
              </div>
            {%- endif -%}
          </div>
        </a>
      {%- endfor -%}
    </div>
  </div>
{%- endif -%}

{% schema %}
{
  "name": "Empty Cart Products",
  "settings": [
    {
      "type": "text",
      "id": "title",
      "label": "Title",
      "default": "Guess you like it"
    },
    {
      "type": "text",
      "id": "heading",
      "label": "Badge text",
      "info": "Badge text shown on all products (same as ss-featured-collection-6)"
    },
    {
      "type": "collection",
      "id": "collection",
      "label": "Collection",
      "info": "Select which collection to show products from"
    },
    {
      "type": "range",
      "id": "product_limit",
      "label": "Number of products",
      "min": 2,
      "max": 8,
      "step": 2,
      "default": 4
    }
  ],
  "presets": [
    {
      "name": "Empty Cart Products"
    }
  ]
}
{% endschema %}
