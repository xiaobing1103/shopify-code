{%- comment -%}
  Product Media - Thumbnails Layout
  缩略图布局（左侧、右侧、底部、无缩略图）
  
  参数:
  - media_layout: 布局类型
  - product_media: 产品媒体数组
  - se_stts: section settings
  - se_id: section id
  - image_ratio: 图片比例
  - imgatt: 图片属性
  - variant_images: 变体图片
  - enable_video_looping: 视频循环
  - enable_video_muting: 视频静音
  - enable_video_autoplaying: 视频自动播放
  - height: 高度
  - isMediaHidden: 媒体隐藏状态
  - current_option1/2/3: 当前选项
  - ops_name, ops_name_1/2/3: 选项名称
  - class_pswp_disable: pswp 禁用类
  - variants_size: 变体数量
  - canMedia_group: 是否可以分组
  - has_media_360: 是否有360度视图
  - media_custom_img_enable: 是否启用自定义图片
  - media_custom_img: 自定义图片
  - media_heading: 媒体标题
  - product: 产品对象
{%- endcomment -%}

{%- liquid
  if media_layout == 'thumbnails_left'
    assign class_main = 't4s-col-lg t4s-order-lg-last '
    assign class_thumb = 't4s-col-lg-auto t4s-order-lg-first '
  elsif media_layout == 'thumbnails_right'
    assign class_main = 't4s-col-lg '
    assign class_thumb = 't4s-col-lg-auto '
  else
    assign class_gx_lg = ' t4s-g-lg-10 '
  endif
-%}

{{ 'slider-settings.css' | asset_url | stylesheet_tag }}

<div class="t4s-row t4s-g-0" timeline hdt-reveal="slide-in">
  <div data-product-single-media-group class="{{ class_main }}t4s-col-12 t4s-col-item t4s-pr">
    <div
      data-t4s-gallery
      data-main-media
      data-t4s-thumb-true
      class="t4s-row t4s-g-0 t4s-slide-eff-{{ se_stts.eff }} flickityt4s t4s_{{ image_ratio }} t4s_position_{{ se_stts.image_position }} t4s_{{ se_stts.image_size }} t4s-flicky-slider {% if se_stts.nav_btn %} t4s-slider-btn-{{ se_stts.nav_btn }} t4s-slider-btn-style-{{ se_stts.btn_owl }} t4s-slider-btn-{{ se_stts.btn_shape }} t4s-slider-btn-{{ se_stts.btn_size }} t4s-slider-btn-cl-{{ se_stts.btn_cl }} t4s-slider-btn-vi-{{ se_stts.btn_vi }} t4s-slider-btn-hidden-mobile-{{ se_stts.btn_hidden_mobile }} {% endif %} {% if se_stts.nav_dot %} t4s-dots-style-{{ se_stts.dot_owl }} t4s-dots-cl-{{ se_stts.dots_cl }} t4s-dots-round-{{ se_stts.dots_round }} t4s-dots-hidden-mobile-{{ se_stts.dots_hidden_mobile }} {% endif %}"
      data-flickityt4s-js='{"t4sid": "{{ se_id }}", "status": true, "checkVisibility": false, "cellSelector": "[data-main-slide]:not(.is--media-hide)","isFilter":{{ canMedia_group }},"imagesLoaded": 0,"adaptiveHeight": 1, "contain": 1, "groupCells": "100%", "dragThreshold" : {% if se_stts.eff == 'fade' %}6{% else %}5{% endif %}, "cellAlign": "left","wrapAround": true,"prevNextButtons": {{ se_stts.nav_btn }},"percentPosition": 1,"pageDots": {{ se_stts.nav_dot }}, "autoPlay" : 0, "pauseAutoPlayOnHover" : true , "thumbNav": {% if media_layout != 'without_thumbnails' %}true{% else %}false{% endif %}, "thumbVertical": {% if media_layout != 'thumbnails_bottom' %}true{% else %}false{% endif %}, "isMedia": true }'
      style="--flickity-btn-pos: 0px;--flickity-btn-pos-mb: 0px;--space-dots: {{ se_stts.dots_space }}px;"
    >
      {%- liquid
        for media in product_media
          if media.preview_image and media.preview_image.alt contains 'break--360'
            break
          endif
          render 'product-thumbnail', media: media, imgatt: imgatt, variant_images: variant_images, loop: enable_video_looping, mute: enable_video_muting, autoplay: enable_video_autoplaying, height: height, se_id: se_id, isMediaHidden: isMediaHidden, current_option1: current_option1, current_option2: current_option2, current_option3: current_option3, ops_name: ops_name, ops_name_1: ops_name_1, ops_name_2: ops_name_2, ops_name_3: ops_name_3, class_pswp_disable: class_pswp_disable, variants_size: variants_size
        endfor
        if has_media_360
          render 'product-360', product: product, se_id: se_id
        endif
      -%}
      {%- if se_stts.nav_dot and se_stts.dot_owl == 'number' -%}
        <div class="flickityt4s-page-dots t4s-dots-list carousel--status{{ se_id }}">
          <span data-current-slide></span> / <span data-total-number></span>
        </div>
      {%- endif -%}
    </div>
    <div
      data-product-single-badge
      data-sort="sale,new,soldout,preOrder,custom"
      class="t4s-single-product-badge lazyloadt4s t4s-pa t4s-pe-none t4s-op-0"
      data-rendert4s="css:{{ 'single-pr-badge.css' | asset_url }}"
    ></div>
    {%- if media_custom_img_enable and media_custom_img != blank -%}
      <div class="t4s-product-media-custom-img-{{ se_id }}">
        {{ media_custom_img | image_url: width: 400 | image_tag: loading: 'lazy', class: 't4s-obj-eff' }}
      </div>
    {%- endif -%}
    {%- if media_heading != blank -%}
      <div class="t4s-product-media-heading-{{ se_id }}">{{ media_heading }}</div>
    {%- endif -%}
    {%- render 'product-btns', se_stts: se_stts, product: product -%}
  </div>

  {%- if media_layout != 'without_thumbnails' -%}
    <div class="{{ class_thumb }}t4s-col-12 t4s-col-item t4s-col-thumb t4s-pr t4s-oh">
      <div
        data-thumb__scroller="{{ se_id }}"
        class="t4s-carousel__nav-scroller is__position-{{ media_layout | remove: 'thumbnails_' }}"
      >
        <div class="t4s-row t4s-row-mt t4s-row-cols-4 t4s_{{ image_ratio }} t4s_position_{{ se_stts.image_position }} t4s_{{ se_stts.image_size }} {{ class_gx_lg }}t4s-g-5 t4s-carousel__nav carousel__nav--{{ se_id }} carousel__nav-hover1">
          {%- for media in product_media limit: 4 -%}
            {%- assign image = media.preview_image -%}
            <div class="t4s-col-item t4s-product__thumb-item">
              <div
                class="t4s_ratio t4s-product__thumb"
                {{ imgatt }}style="--aspect-ratioapt:{{ image.aspect_ratio }}"
              ></div>
            </div>
          {%- endfor -%}
        </div>
      </div>
      <button
        type="button"
        data-thumb-btn__prev="{{ se_id }}"
        aria-label="Previous"
        class="btn_pnav_prev t4s-pa t4s-pe-none t4s-op-0"
      ></button>
      <button
        type="button"
        data-thumb-btn__next="{{ se_id }}"
        aria-label="Next"
        class="btn_pnav_next t4s-pa t4s-pe-none t4s-op-0"
      ></button>
    </div>
  {%- endif -%}
</div>
